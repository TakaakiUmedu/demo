<!DOCTYPE html>
<html lang="ja">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />

<link rel="stylesheet" href="layout-default2.css"></link>
<link rel="stylesheet" href="color-default2.css"></link>
<link rel="stylesheet" href="sort.css"></link>

<script src="sort.js"></script>

<title>安定ソートと不安定ソートの体験デモ</title>

</head>
<body>
<h1>安定ソートと不安定ソートの体験デモ</h1>

<div style="display:flex;">
<div style="min-width:25em;center;">
<ul id="menu" style="margin:0;">
</ul>

<p>
<label><input id="stable" type="radio" name="sort_kind"></input>安定ソート</label>
<label><input type="radio" checked="checked" name="sort_kind"></input>不安定ソート</label>
</p>

<div id="tables">
</div>
</div>

<div id="comment">

<h4>説明</h4>

<ul>
<li>表のタイトル行をクリックすると、そのカラムでソートされる</li>
<li><q>安定ソート</q>にチェックを入れた場合は、安定ソートを用いて、そうでない場合は不安定にソートが実行される</li>
<li>ただし、あくまでイメージであり、何らかの不安定なソートアルゴリズムを用いているのではなく乱数で無理矢理乱しているので、一般的な不安定なソートではあり得ないような結果になるかも知れないがご容赦下さい</li>
</ul>


<h4>販売店検索</h4>
<ul>
<li>各地の店舗の在庫と販売価格を検索出来るようなサイトのイメージ</li>
<li>不安定なソートにした場合、<q>価格</q>でソートして最安値の順に並べた場合、最寄り駅の順序が無茶苦茶になる。
結果として、<q>最も安いうち、家から最も近い店舗に買いに行きたい</q>という要望を満たすには、上から順に最安値店舗の最寄り駅を確認していく作業が必要になり、めんどくさい</li>
<li>安定なソートを使った場合は、<q>駅番号</q>でソート→<q>価格</q>でソート、という手順で、最安値が上に固まり、さらに最安値の店舗は駅番号の順に並んだ状態になり、最寄り駅を探し出しやすくなる</li>
</ul>

<h4>成績表</h4>
<ul>
<li><q>最高点を取った人に檀上に上がって貰って表彰する</q>というシチュエーションを考える</li>
<li><q>点数</q>で不安定なソートを実行すると、100点を取った人の順番がばらばらになり、<q>100点を取った人は、14番、20番、4番、10番の4人です、檀上にお上がりください</q>など、どんな順番で呼ばれるか分からなくなる</li>
<li>安定なソートであれば、<q>出席番号</q>でソート→<q>点数</q>でソート、とすると、<q>100点を取った人は、4番、10番、14番、20番の4人です、檀上にお上がりください</q>と、番号が小さい順に呼び出せる</li>
<li>なお、いつ呼ばれるか分からないドキドキ感を演出したい場合は、順番がばらばらの方が良いという考え方もある。順番通りだと、<q>10番が呼ばれちゃったから、出席番号7番の自分はトップではなかったか</q>と、呼び出し途中で推測が出来てしまう</li>
</ul>

<h4>対処方法</h4>

<ul>
<li>不安定ソートを使って、<q>○○の順に並んだ結果が欲しい。その上で、○○が等しいところは△△の順に並べて欲しい</q>というような要望に応える場合は2つほどの方針が考えられる</li>
<li>1つ目は、比較を工夫する方法である。ソートの際には、<q>2つの項目のうち、どちらが先にないとダメか?</q>という比較が行われる。
数値ならどちらが小さいか、文字列ならどちらが辞書順で先か、などの比較である。
この比較を、<q>○○が等しくない場合は○○の順、○○が等しければ△△の順</q>という判定方法で行えば良い。
多くのプログラミング言語のソート関数などは、<code>a</code>と<code>b</code>の順序判定を行う<code>compare(a, b)</code>関数をソートのオプションとして指定できる仕組みを持っている。
そこに、要望を満たす比較関数を渡せば目的を達成できる。
他には、ソート対象を一度、各項目を<code>[○○の値, △△の値]</code>とするようなデータに変換しておいてソートすることも目的を達成できる。Pythonはこちらの仕組みを採用していて、
詳しくは、Python公式のドキュメントの<a class="ref" href="https://docs.python.org/ja/3/howto/sorting.html">Sorting Techniques</a>などを参照のこと。
</li>
<li>2つ目は、まず、○○の順にソートし、それが終わったら○○が等しい範囲のそれぞれに個別に対して、△△の順に並び替えるという方法であり、
実装が複雑になるためあまりお勧めできない</li>

<li>安定なソートを使うと、△△の順にソートする→○○の順にソートする、とするだけで済む。
今回の表のようなUIの場合は、上記の1つ目、2つ目の方法では、どういうソートをしたいのか? というのを指示しづらいため、安定なソートが出来るとらくである</li>
<li>なお、不安定なソート関数しかない場合に安定なソートを実現したい場合は、上記の1つ目の方法を応用して、ソートする前に「現在の順序」のデータを作り、
それを、△△としてソートするような仕組みにすれば実現できる。</li>
</ul>


</div>
</div>


</body>
</html>
